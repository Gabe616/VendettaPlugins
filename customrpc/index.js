(function(M,je,t,S,g,R,y,me,o,Ye,p,he,We){"use strict";const{TextStyleSheet:Ke}=g.findByProps("TextStyleSheet"),{View:D,Text:ie,Pressable:qe}=y.General,{FormRow:Qe}=y.Forms;function Ze(e){const n=g.findByProps("colors","meta"),a=g.findByStoreName("ThemeStore");return n.meta.resolveSemanticColor(a.theme,e)}function et(e,n){const a=e.discriminator==="0";return e.avatar?`https://cdn.discordapp.com/avatars/${e.id}/${n&&e.avatar.startsWith("a_")?`${e.avatar}.gif`:`${e.avatar}.png`}`:`https://cdn.discordapp.com/embed/avatars/${a?(parseInt(e.id)>>22)%6:parseInt(e.discriminator)%5}`}function z(e){let{title:n,onTitlePress:a,icon:r,children:l,padding:i}=e;const c=t.stylesheet.createThemedStyleSheet({androidRipple:{color:R.semanticColors.ANDROID_RIPPLE},mainText:{fontFamily:t.constants.Fonts.PRIMARY_SEMIBOLD,fontSize:14,includeFontPadding:!1,letterSpacing:void 0,lineHeight:18,textTransform:"none",color:R.semanticColors.HEADER_SECONDARY},icon:{height:14,tintColor:R.semanticColors.HEADER_SECONDARY},main:{backgroundColor:R.semanticColors.BACKGROUND_TERTIARY,borderRadius:16,overflow:"hidden",flex:1}}),u=a?qe:D;return t.React.createElement(D,{style:{marginHorizontal:16,marginTop:16}},t.React.createElement(u,{android_ripple:c.androidRipple,disabled:!1,accessibilityRole:"button",onPress:a,style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},r&&t.React.createElement(D,{style:{marginRight:4}},t.React.createElement(Qe.Icon,{style:c.icon,source:r,size:"small"})),t.React.createElement(ie,{style:c.mainText},n)),t.React.createElement(D,{style:c.main},i?t.React.createElement(D,{style:{paddingHorizontal:16,paddingVertical:16}},l):l))}function tt(e){let{addPadding:n}=e;const a=t.stylesheet.createThemedStyleSheet({line:{width:"100%",height:2,backgroundColor:R.semanticColors.BACKGROUND_ACCENT,borderRadius:2147483647}});return t.React.createElement(D,{style:[{marginTop:16,marginBottom:16},n&&{marginHorizontal:16}]},t.React.createElement(D,{style:a.line}))}var re;(function(e){function n(r){let{children:l,onPress:i}=r;return t.React.createElement(m,{variant:"text-md/bold",onPress:i},l)}e.Bold=n;function a(r){let{children:l,onPress:i}=r;return t.React.createElement(ie,{style:{textDecorationLine:"underline"},onPress:i},l)}e.Underline=a})(re||(re={}));function m(e){let{variant:n,lineClamp:a,color:r,align:l,style:i,onPress:c,getChildren:u,children:f,liveUpdate:N}=e;const[Xe,qt]=t.React.useReducer(function(Zt){return~Zt},0),Qt=new Date().setMilliseconds(1e3);return N&&setTimeout(function(){return qt()},Qt-Date.now()),t.React.createElement(ie,{style:[n?Ke[n]:{},r?{color:Ze(R.semanticColors[r])}:{},l?{textAlign:l}:{},i??{}],numberOfLines:a,onPress:c},u?.()??f)}function G(e){let{onPress:n,icon:a,style:r,destructive:l}=e;const i=t.stylesheet.createThemedStyleSheet({headerStyleIcon:{marginRight:10,tintColor:R.semanticColors.HEADER_PRIMARY},cardStyleIcon:{width:22,height:22,marginLeft:5,tintColor:R.semanticColors.INTERACTIVE_NORMAL},destructiveIcon:{tintColor:R.semanticColors.TEXT_DANGER}});return t.React.createElement(t.ReactNative.TouchableOpacity,{onPress:n},t.React.createElement(t.ReactNative.Image,{style:[typeof r=="string"?r==="header"?i.headerStyleIcon:i.cardStyleIcon:r,l&&i.destructiveIcon].filter(function(c){return!!c}),source:a}))}function X(e){return typeof e=="object"&&!Array.isArray(e)}function at(e,n){if(e.storage.changelog??=n.length,e.storage.changelog!==n.length){const a=n[0],r=[];for(const l in a.changes){const i=a.changes[l];r.push(React.createElement(m,{color:i.startsWith("+ ")?"TEXT_POSITIVE":i.startsWith("- ")?"TEXT_DANGER":void 0},i)),l!==(a.changes.length-1).toString()&&r.push(`
`)}S.showConfirmationAlert({title:`${e.manifest.name} Changelog`,content:[React.createElement(m,{variant:"text-lg/semibold",align:"center"},`v1.${n.length-1}${a.label?` (${a.label})`:""}`),`
`,...r],confirmText:"Ok",confirmColor:"grey",onConfirm:function(){return e.storage.changelog=n.length}})}}var Re={github:{url:"https://github.com/Gabe616/VendettaPlugins/"}};const{showSimpleActionSheet:nt}=g.findByProps("showSimpleActionSheet"),it=g.findByStoreName("UserStore");function rt(){const e=Ye.getDebugInfo(),n=t.ReactNative.NativeModules.InfoDictionaryManager??t.ReactNative.NativeModules.RTNClientInfoManager;return`Device: ${e.os.name==="iOS"?e.device.codename:`${e.device.brand} ${e.device.model}`}
Model: ${e.device.model}
Manufacturer: ${e.device.manufacturer}
Brand: ${e.device.brand}

OS: ${e.os.name}
Version: ${e.os.version}

Discord Branch: ${n.ReleaseChannel}
Discord Version: ${e.discord.version}
Discord Build: ${e.discord.build}
Vendetta Version: ${e.vendetta.version}

React Version: ${e.react.version}
Hermes Bytecode: ${e.hermes.bytecodeVersion}`}function ve(e){const n=it.getCurrentUser(),a=new URLSearchParams;for(const[r,l]of Object.entries(e))a.set(r,l);return a.set("discord-username",`@${n.username}${n.discriminator!=="0"?`#${n.discriminator}`:""}`),console.log(`${Re.github.url}issues/new?${a.toString()}`),`${Re.github.url}issues/new?${a.toString()}`}const st=function(e){return nt({key:"CardOverflow",header:{title:"GitHub Reports"},options:[{label:"Copy bug report link",icon:o.getAssetIDByName("copy"),onPress:function(){t.clipboard.setString(ve({title:`bug(${e}): `,template:"bug_report.yml",labels:"bug",sysinfo:rt()})),p.showToast("Copied",o.getAssetIDByName("toast_copy_link"))}},{label:"Copy feature suggestion link",icon:o.getAssetIDByName("copy"),onPress:function(){t.clipboard.setString(ve({title:`suggest(${e}): `,labels:"suggestion",template:"suggestion.yml"})),p.showToast("Copied",o.getAssetIDByName("toast_copy_link"))}}]})},se="https://discord.com/api/v9/",{getToken:le}=g.findByProps("getToken");async function lt(){return await(await he.safeFetch(`${se}applications?with_team_applications=true`,{headers:{authorization:le()}})).json()}async function ct(e){return await(await he.safeFetch(`${se}oauth2/applications/${e}/assets`,{cache:"no-store",headers:{authorization:le()}})).json()}const T={};async function Ee(e){if(T[e])return T[e];T[e]="pending";let n=(await(await fetch(`${se}applications/0/external-assets`,{method:"POST",headers:{authorization:le(),"content-type":"application/json"},body:JSON.stringify({urls:[e]})})).json())[0].external_asset_path;return n.startsWith("https://media.discordapp.net")&&(n=n.split("/").slice(3).join("/")),T[e]=n,n}const be=g.findByProps("isTablet"),{View:Ae,Text:ot,Image:ut}=y.General,{TextStyleSheet:dt}=g.findByProps("TextStyleSheet"),ce=t.stylesheet.createThemedStyleSheet({card:{backgroundColor:R.semanticColors.BACKGROUND_SECONDARY,marginHorizontal:4,marginVertical:4,borderRadius:8,flex:1},cardHeader:{backgroundColor:R.semanticColors.BACKGROUND_TERTIARY,borderTopLeftRadius:8,borderTopRightRadius:8,paddingHorizontal:8,paddingVertical:8,width:"100%"},cardHeaderText:{...dt["text-sm/semibold"],color:R.semanticColors.TEXT_NORMAL},cardImage:{width:"100%",flex:1,borderBottomLeftRadius:8,borderBottomRightRadius:8}}),pt=function(){const e=t.NavigationNative.useNavigation(),[n,a]=t.React.useState(""),[r,l]=t.React.useState();t.React.useEffect(function(){a("")}),r||ct(fe).then(l);let i=!1;return r?t.React.createElement(t.ReactNative.FlatList,{ListEmptyComponent:t.React.createElement(y.Search,{style:{marginBottom:10},onChangeText:function(c){return a(c.toLowerCase())}}),style:{paddingHorizontal:10,paddingTop:10},contentContainerStyle:{paddingBottom:20},data:r.filter(function(c){return c.name.toLowerCase().includes(n)}),numColumns:be.isTablet?3:2,renderItem:function(c){const{item:u}=c;return t.React.createElement(t.ReactNative.TouchableOpacity,{onPress:function(){i||(i=!0,e.goBack(),pe?.(u.id))},style:{width:`${be.isTablet?1/.03:1/.02}%`,aspectRatio:1}},t.React.createElement(Ae,{style:ce.card},t.React.createElement(Ae,{style:ce.cardHeader},t.React.createElement(ot,{style:ce.cardHeaderText},u.name)),t.React.createElement(ut,{source:{uri:`https://cdn.discordapp.com/app-assets/${fe}/${u.id}.png?size=128`}})))}}):t.React.createElement(t.ReactNative.ActivityIndicator,{style:{flex:1}})};function ft(e){e.push("VendettaCustomPage",{render:pt,title:"Select Asset"})}const{View:Se,Image:gt}=y.General;let Ie;const yt=function(){const e=t.NavigationNative.useNavigation(),[n,a]=t.React.useState(""),[r,l]=t.React.useState();Ie=function(){return!i&&S.showInputAlert({title:"Custom App ID",placeholder:"123",confirmText:"Use",confirmColor:"blue",onConfirm:function(c){if(c.match(/^\s*$/))return p.showToast("App ID cannot be empty",o.getAssetIDByName("Small"));if(Number.isNaN(Number(c)))return p.showToast("Invalid app ID",o.getAssetIDByName("Small"));Z({id:c})}})},t.React.useEffect(function(){a("")},[]),r||lt().then(l);let i=!1;return r?t.React.createElement(t.ReactNative.FlatList,{ListHeaderComponent:t.React.createElement(y.Search,{style:{marginBottom:10},onChangeText:function(c){return a(c.toLowerCase())}}),style:{paddingHorizontal:10,paddingTop:10},contentContainerStyle:{paddingBottom:20},data:r.filter(function(c){return c.name.toLowerCase().includes(n.toLowerCase())}),renderItem:function(c){const{item:u}=c;return t.React.createElement(t.ReactNative.TouchableOpacity,{onPress:function(){i||(i=!0,e.goBack(),Z?.({id:u.id,name:u.name}))}},t.React.createElement(Se,{style:{marginHorizontal:8,marginBottom:8,flexDirection:"row"}},t.React.createElement(gt,{source:{uri:u.icon?`https://cdn.discordapp.com/app-icons/${u.icon}/${u.icon}.png?size=64`:A.image},style:{borderRadius:8,resizeMode:"cover",aspectRatio:1}}),t.React.createElement(Se,{style:{flexDirection:"column",marginLeft:8}},t.React.createElement(m,{variant:"text-md/semibold",color:"TEXT_NORMAL"},u.name),t.React.createElement(m,{variant:"text-sm/medium",color:"TEXT_MUTED",lineClamp:1},u.description))))}}):t.React.createElement(t.ReactNative.ActivityIndicator,{style:{flex:1}})};function mt(e){e.push("VendettaCustomPage",{render:yt,title:"Select Application",headerRight:function(){return t.React.createElement(G,{style:"header",icon:o.getAssetIDByName(""),onPress:function(){return Ie?.()}})}})}function Ce(e){const n=Math.abs(Math.floor(e/1e3)),a=Math.floor(n/3600),r=Math.floor(n/60)%60,l=n%60;return`${a?`${a.toString().padStart(2,"0")}:`:""}${r.toString().padStart(2,"0")}:${l.toString().padStart(2,"0")}`}function oe(e){const n=Math.floor(e/60),a=e%60;return new Date().setHours(n,a,0,0)}function Ne(e){const n=new Date(e);return n.getHours()*60+n.getMinutes()}function j(e,n){if(e.startsWith("spotify:"))return`https://i.scdn.co/image/${e.slice(8)}`;if(e.startsWith("mp:"))return`https://media.discordapp.net/${e.slice(3)}`;if(!Number.isNaN(Number(e)))return`https://cdn.discordapp.com/app-assets/${n??"1"}/${e}.png?size=56`}const Te={online:"mp:attachments/919655852724604978/1125529509723123712/s_online.png",idle:"mp:attachments/919655852724604978/1125529509467279451/s_idle.png",dnd:"mp:attachments/919655852724604978/1125529509236572301/s_dnd.png",offline:"mp:attachments/919655852724604978/1125529508980731954/s_offline.png"},ht=g.findByStoreName("UserStore"),{View:I,Image:we,Pressable:Pe}=y.General,Rt=g.findByName("UserActivityContainer"),F=t.stylesheet.createThemedStyleSheet({actTypeCont:{flexDirection:"row",marginBottom:12,justifyContent:"space-between"},card:{borderWidth:1,borderRadius:8,borderColor:R.semanticColors.BACKGROUND_MODIFIER_ACCENT},card2:{alignItems:"flex-start",flexDirection:"row"},images:{position:"relative",marginRight:10},smallImageBg:{borderColor:R.semanticColors.BACKGROUND_PRIMARY,backgroundColor:R.semanticColors.BACKGROUND_PRIMARY,borderWidth:1,borderRadius:18,position:"absolute",right:-4,bottom:-4}});let De;function vt(e){let{edit:n,act:a}=e;const[r,l]=t.React.useReducer(function(u){return~u},0);De=l;const i=t.NavigationNative.useNavigation(),c=function(){l(),ae?.()};return n?t.React.createElement(t.React.Fragment,null,t.React.createElement(I,{style:F.actTypeCont},t.React.createElement(m,{variant:"eyebrow",color:"TEXT_NORMAL",onPress:function(){return b(_t,{type:a.type??L.Playing,update:function(u){a.type=u,c()}})}},Fe[a.type??L.Playing]," ...")),t.React.createElement(I,{style:F.card},t.React.createElement(I,{style:{padding:16}},t.React.createElement(I,{style:F.card2},t.React.createElement(I,{style:F.images},t.React.createElement(Pe,{onPress:function(){return b(xe,{appId:a.app.id,role:"Large",image:a.assets.largeImg,navigation:i,update:function(u){a.assets.largeImg=u,c()}})}},t.React.createElement(we,{source:{uri:j(a.assets.largeImg??".",a.app.id)??A.image},style:{borderRadius:3,width:56,height:56}})),t.React.createElement(I,{style:F.smallImageBg},t.React.createElement(Pe,{onPress:function(){return b(xe,{appId:a.app.id,role:"Small",image:a.assets.smallImg,navigation:i,update:function(u){a.assets.smallImg=u,c()}})}},t.React.createElement(we,{source:{uri:j(a.assets.smallImg??".",a.app.id)??A.image},style:{borderRadius:14,width:28,height:28}})))),t.React.createElement(I,{style:{flex:1}},t.React.createElement(m,{variant:"text-md/semibold",color:"TEXT_NORMAL",onPress:function(){return b(Bt,{appId:a.app.id,appName:a.app.name,navigation:i,update:function(u){u?.id!==a.app.id&&(Number.isNaN(Number(a.assets.smallImg))||delete a.assets.smallImg,Number.isNaN(Number(a.assets.largeImg))||delete a.assets.largeImg),a.app.id=u?.id,a.app.name=u?.name,c()}})}},a.app.name??A.appName),t.React.createElement(m,{variant:"text-sm/normal",color:"TEXT_NORMAL",onPress:function(){return J({role:"Details",current:a.details,update:function(u){a.details=u,c()}})}},a.details??A.details),t.React.createElement(m,{variant:"text-sm/normal",color:"TEXT_NORMAL",onPress:function(){return J({role:"State",current:a.state,update:function(u){a.state=u,c()}})}},a.state??A.state),t.React.createElement(m,{variant:"text-sm/normal",color:"TEXT_NORMAL",onPress:function(){return b(xt,{start:a.timestamps.start,end:a.timestamps.end,update:function(u){a.timestamps.start=u.start,a.timestamps.end=u.end,c()}})},liveUpdate:!0,getChildren:function(){return typeof a.timestamps.end=="string"?`{${a.timestamps.end}}`:typeof a.timestamps.end=="number"?`${Ce(oe(a.timestamps.end)-Date.now())} left`:typeof a.timestamps.start=="string"?`{${a.timestamps.start}}`:typeof a.timestamps.start=="number"?`${Ce(Date.now()-oe(a.timestamps.start))} elapsed`:A.timestamp}}))),t.React.createElement(I,{style:{marginTop:16}},t.React.createElement(y.Button,{text:a.buttons[0]?.text??A.button1,style:{backgroundColor:"grey"},size:"small",onPress:function(){return b($e,{role:"1",text:a.buttons[0]?.text,url:a.buttons[0]?.url,update:function(u){let{text:f,url:N}=u;!f&&!N?a.buttons[0]=void 0:a.buttons[0]={text:f,url:N},c()}})}})),t.React.createElement(I,{style:{marginTop:10}},t.React.createElement(y.Button,{text:a.buttons[1]?.text??A.button2,style:{backgroundColor:"grey"},size:"small",onPress:function(){return b($e,{role:"2",text:a.buttons[1]?.text,url:a.buttons[1]?.url,update:function(u){let{text:f,url:N}=u;!f&&!N?a.buttons[1]=void 0:a.buttons[1]={text:f,url:N},c()}})}}))))):t.React.createElement(Rt,{user:ht.getCurrentUser(),activity:He(a).activity})}let Y={};function Et(e,n,a,r){if(Y[e])return;const l={default:r,timeout:-1};Y[e]=l;const i=function(){const c=n(new Date);l.timeout=setTimeout(function(){a(),i()},c-Date.now())};i()}const W={};function Be(e,n,a,r){W[e]||(t.FluxDispatcher.subscribe(n,a),W[e]={default:r,event:n,handler:a})}function _e(e){for(const[n,a]of Object.entries(Y))(e||!a.default)&&(clearTimeout(a.timeout),delete Y[n]);for(const[n,a]of Object.entries(W))(e||!a.default)&&(t.FluxDispatcher.unsubscribe(a.event,a.handler),delete W[n])}function bt(){Et("auto_fix_timestamps",function(e){return e.setHours(24,0,0,0)},K,!0)}function K(){De?.(),H()}const k=g.findByStoreName("UserStore"),C=g.findByStoreName("SpotifyStore"),ue=g.findByStoreName("PresenceStore");var E;(function(e){e[e.CurrentUser=0]="CurrentUser",e[e.CurrentUserPresence=1]="CurrentUserPresence"})(E||(E={}));const w={presence:{status:void 0,custom:void 0,spotify:null}},de=function(e){return(e??ue.getActivities(k.getCurrentUser().id)).find(function(n){return n.type===4})},At=[{match:"{user.name}",meta:{description:"your username"},types:[E.CurrentUser],replace:function(){return k.getCurrentUser().username}},{match:"{user.displayname}",meta:{description:"your display name"},types:[E.CurrentUser],replace:function(){return k.getCurrentUser().globalName}},{match:"{user.status}",meta:{description:"your status"},types:[E.CurrentUserPresence],replace:function(){return de()?.label??"No Status"}},{match:"{user.presence}",meta:{description:"your presence (online/dnd/idle/invisible)"},types:[E.CurrentUserPresence],replace:function(){return ue.getStatus(k.getCurrentUser().id)}},{match:"{spotify.track}",meta:{description:"your playing Spotify track (Thot K)"},types:[E.CurrentUserPresence],replace:function(){return C.getActivity()?.details??"No Spotify Track"}},{match:"{spotify.track.url}",meta:{description:"your playing Spotify track's share link"},types:[E.CurrentUserPresence],replace:function(){const e=C.getActivity()?.sync_id;return e?`https://open.spotify.com/track/${e}`:""}},{match:"{spotify.artist}",meta:{description:"your playing Spotify track's artist(s) (iluvern!)"},types:[E.CurrentUserPresence],replace:function(){return(w.presence.spotify=C.getActivity())?.state??"No Spotify Track"}},{match:"{spotify.album}",meta:{description:"your playing Spotify track's album (iluvern!)"},types:[E.CurrentUserPresence],replace:function(){return(w.presence.spotify=C.getActivity())?.assets?.large_text??"No Spotify Track"}}];function St(e){const n={content:e,types:[]};for(const a of At){let r;n.content=n.content.replaceAll(a.match,function(){for(const l of a.types)n.types.includes(l)||n.types.push(l);return r??(r=a.replace())})}return n}const q=[{title:"Spotify Track Start",description:"The timestamp when your playing Spotify track sarstarted",format:"spotify.track.start",type:E.CurrentUserPresence,replace:function(){return(w.presence.spotify=C.getActivity())?.timestamps?.start}},{title:"Spotify Track End",description:"The timestamp when your playing Spotify track ends",format:"spotify.track.end",type:E.CurrentUserPresence,replace:function(){return(w.presence.spotify=C.getActivity())?.timestamps?.end}}];function It(e){if(typeof e=="string"){const n=q.find(function(r){return r.format===e}),a=n?.replace();return n?{timestamp:a!==void 0?Ne(a):void 0,type:n.type}:{timestamp:0}}else return{timestamp:e}}const Q=[{title:"User Avatar",description:"Your avatar",format:"user.avatar",type:E.CurrentUser,replace:function(){const e=k.getCurrentUser(),n=et({discriminator:e.discriminator,id:e.id,avatar:e.avatar});return T[n]||Ee(n).then(K),`mp:${T[n]}`}},{title:"User Presence",description:"Your presence (online/idle/dnd/invisible)",format:"user.presence",type:E.CurrentUserPresence,replace:function(){return Te[ue.getStatus(k.getCurrentUser().id)]??Te.online}},{title:"Spotify Album Cover",description:"Your playing Spotify track's album cover",format:"spotify.album",type:E.CurrentUserPresence,replace:function(){return C.getActivity()?.assets?.large_image}}];function Ct(e){const n=Q.find(function(a){return a.format===e});return n?{image:n.replace(),type:n.type}:{image:e}}function Nt(e){for(const n of e)n===E.CurrentUser?Be("parsed.currentuser","CURRENT_USER_UPDATE",K):n===E.CurrentUserPresence&&Be("parsed.currentuserpresence","SELF_PRESENCE_STORE_UPDATE",function(a){(w.presence.status!==a.status||JSON.stringify(w.presence.custom)!==JSON.stringify(de(a.activities))||JSON.stringify(w.presence.spotify)!==JSON.stringify(C.getActivity()))&&K(),w.presence={status:a.status,custom:de(a.activities),spotify:C.getActivity()}})}const{View:Tt,ScrollView:B}=y.General,{FormRow:d,FormRadioRow:wt}=y.Forms,{default:{render:P}}=g.find(function(e){return e.default?.render?.name==="ActionSheet"})??{default:{render:!1}},h=g.findByProps("openLazy","hideActionSheet"),{ActionSheetTitleHeader:_,ActionSheetCloseButton:x}=g.findByProps("ActionSheetTitleHeader","ActionSheetCloseButton"),Pt=g.findByProps("DatePickerModes"),$=function(){return t.React.createElement(Tt,{style:{marginBottom:16}})};function b(e,n){P?h.openLazy(new Promise(function(a){return a({default:e})}),"ActionSheet",n):p.showToast("You cannot open ActionSheets on this version! Update to 163+",o.getAssetIDByName("Small"))}const U=t.stylesheet.createThemedStyleSheet({destructiveIcon:{tintColor:R.semanticColors.TEXT_DANGER}}),V={color:"TEXT_DANGER",variant:"text-md/semibold"};function Dt(e){let{role:n,update:a}=e;return t.React.createElement(P,null,t.React.createElement(B,null,t.React.createElement(_,{title:`${n} Image Variable`,trailing:t.React.createElement(x,{onPress:function(){return h.hideActionSheet()}})}),Q.map(function(r){return t.React.createElement(d,{label:r.title,subLabel:r.description,trailing:t.React.createElement(d.Arrow,null),onPress:function(){a(r.format),h.hideActionSheet()}})})),t.React.createElement($,null))}let pe,fe;function xe(e){let{appId:n,role:a,image:r,navigation:l,update:i}=e;return t.React.createElement(P,null,t.React.createElement(B,null,t.React.createElement(_,{title:`Edit ${a} Image`,trailing:t.React.createElement(x,{onPress:h.hideActionSheet})}),t.React.createElement(d,{label:"Set Image Variable",leading:t.React.createElement(d.Icon,{source:o.getAssetIDByName("ic_essentials_sparkle")}),trailing:t.React.createElement(d.Arrow,null),onPress:function(){return b(Dt,{role:a,update:function(c){return i(c)}})}}),t.React.createElement(d,{label:"Use Custom Image",subLabel:"Make sure your image is in a square aspect ratio",leading:t.React.createElement(d.Icon,{source:o.getAssetIDByName("ic_link")}),onPress:function(){S.showInputAlert({title:"Enter the link to your image link",placeholder:"can be a discord attachment CDN link",confirmText:"Proxy",confirmColor:"brand",cancelText:"Cancel",onConfirm:async function(c){const u=c.match(me.constants.HTTP_REGEX_MULTI)?.[0];if(!u)return p.showToast("Invalid URL",o.getAssetIDByName("Small"));p.showToast("Proxying image...",o.getAssetIDByName("ic_clock"));try{i(`mp:${await Ee(u)}`),p.showToast("Proxied image",o.getAssetIDByName("Check"))}catch(f){console.log(f),p.showToast("Failed to proxy image",o.getAssetIDByName("Small"))}}})}}),t.React.createElement(d,{label:"Select RPC Asset",leading:t.React.createElement(d.Icon,{source:o.getAssetIDByName("ic_media_channel")}),trailing:t.React.createElement(d.Arrow,null),onPress:function(){if(!n)return S.showConfirmationAlert({title:"No App Set",content:"An app must be selected in order to use RPC assets",confirmText:"Ok",confirmColor:"grey",onConfirm:function(){}});fe=n,pe=function(c){pe=void 0,i(c)},ft(l),h.hideActionSheet()}}),r&&t.React.createElement(d,{label:t.React.createElement(m,V,"Remove Image"),leading:t.React.createElement(d.Icon,{style:U.destructiveIcon,source:o.getAssetIDByName("trash")}),onPress:function(){i(void 0),h.hideActionSheet()}})),t.React.createElement($,null))}function $e(e){let{role:n,text:a,url:r,update:l}=e;return t.React.createElement(P,null,t.React.createElement(B,null,t.React.createElement(_,{title:`Edit Button ${n}`,trailing:t.React.createElement(x,{onPress:h.hideActionSheet})}),t.React.createElement(d,{label:"Button Text",leading:t.React.createElement(d.Icon,{source:o.getAssetIDByName("ic_message_edit")}),onPress:function(){return J({role:`Button ${n} Text`,current:a,update:function(i){return l({text:i,url:r})}})}}),t.React.createElement(d,{label:"Button URL",leading:t.React.createElement(d.Icon,{source:o.getAssetIDByName("ic_message_edit")}),onPress:function(){return J({role:`Button ${n} URL`,current:r,update:function(i){return l({text:a,url:i})}})}}),r&&t.React.createElement(d,{label:t.React.createElement(m,V,"Remove Button URL"),leading:t.React.createElement(d.Icon,{style:U.destructiveIcon,source:o.getAssetIDByName("trash")}),onPress:function(){l({text:a,url:void 0}),h.hideActionSheet()}}),a&&t.React.createElement(d,{label:t.React.createElement(m,V,"Remove Button"),leading:t.React.createElement(d.Icon,{style:U.destructiveIcon,source:o.getAssetIDByName("trash")}),onPress:function(){l(void 0),h.hideActionSheet()}})),t.React.createElement($,null))}let Z;function Bt(e){let{appId:n,appName:a,navigation:r,update:l}=e;return t.React.createElement(P,null,t.React.createElement(B,null,t.React.createElement(_,{title:"Edit Application",trailing:t.React.createElement(x,{onPress:h.hideActionSheet})}),t.React.createElement(d,{label:"Application Name",leading:t.React.createElement(d.Icon,{source:o.getAssetIDByName("ic_message_edit")}),onPress:function(){return J({role:"Application Name",current:a,update:function(i){return l({id:n,name:i})}})}}),t.React.createElement(d,{label:"Select Application",leading:t.React.createElement(d.Icon,{source:o.getAssetIDByName("ic_robot_24px")}),trailing:t.React.createElement(d.Arrow,null),onPress:function(){Z=function(i){Z=void 0,l({id:i.id??n,name:i.name??a})},mt(r),h.hideActionSheet()}}),n&&t.React.createElement(d,{label:t.React.createElement(m,V,"Remove Application"),leading:t.React.createElement(d.Icon,{style:U.destructiveIcon,source:o.getAssetIDByName("trash")}),onPress:function(){l(void 0),h.hideActionSheet()}})),t.React.createElement($,null))}function _t(e){let{type:n,update:a}=e;const[r,l]=t.React.useState(n);return t.React.createElement(P,null,t.React.createElement(B,null,t.React.createElement(_,{title:"Edit Activity Type",trailing:t.React.createElement(x,{onPress:function(){return h.hideActionSheet()}})}),...Object.values(L).filter(function(i){return typeof i=="number"}).map(function(i){return t.React.createElement(wt,{label:Fe[i],trailing:t.React.createElement(d.Arrow,null),selected:i===r,onPress:function(){a(i),l(i)}})})),t.React.createElement($,null))}function Le(e){let{role:n,update:a}=e;return t.React.createElement(P,null,t.React.createElement(B,null,t.React.createElement(_,{title:`Set ${n} Time Variable`,trailing:t.React.createElement(x,{onPress:function(){return h.hideActionSheet()}})}),q.map(function(r){return t.React.createElement(d,{label:r.title,subLabel:r.description,trailing:t.React.createElement(d.Arrow,null),onPress:function(){a(r.format),h.hideActionSheet()}})})),t.React.createElement($,null))}function xt(e){let{start:n,end:a,update:r}=e;const l=function(i){let{role:c,onSubmit:u}=i;const f=new Date().setHours(0,0,0,0),N=new Date().setHours(23,59,59,999);h.openLazy(Promise.resolve(Pt),"DatePicker",{onSubmit:function(Xe){return u(Ne(Xe._d.getTime()))},title:`Timestamp ${c} Time`,startDate:new Date,minimumDate:new Date(f),maximumDate:new Date(N),requireDateChanged:!1,mode:"time"})};return t.React.createElement(P,null,t.React.createElement(B,null,t.React.createElement(_,{title:"Edit Timestamp",trailing:t.React.createElement(x,{onPress:function(){return h.hideActionSheet()}})}),t.React.createElement(d,{label:"Set Start Time Variable",leading:t.React.createElement(d.Icon,{source:o.getAssetIDByName("ic_essentials_sparkle")}),trailing:t.React.createElement(d.Arrow,null),onPress:function(){return b(Le,{role:"Start",update:function(i){return r({start:i,end:a})}})}}),typeof n!="string"&&t.React.createElement(d,{label:"Edit Start Time",leading:t.React.createElement(d.Icon,{source:o.getAssetIDByName("ic_message_edit")}),trailing:t.React.createElement(d.Arrow,null),onPress:function(){return l({role:"Start",onSubmit:function(i){return r({start:i,end:a})}})}}),n!==void 0&&t.React.createElement(d,{label:t.React.createElement(m,V,"Remove Start Time"),leading:t.React.createElement(d.Icon,{style:U.destructiveIcon,source:o.getAssetIDByName("trash")}),onPress:function(){r({start:void 0,end:a}),h.hideActionSheet()}}),t.React.createElement(d,{label:"Set End Time Variable",leading:t.React.createElement(d.Icon,{source:o.getAssetIDByName("ic_essentials_sparkle")}),trailing:t.React.createElement(d.Arrow,null),onPress:function(){return b(Le,{role:"End",update:function(i){return r({start:n,end:i})}})}}),typeof a!="string"&&t.React.createElement(d,{label:"Edit End Time",leading:t.React.createElement(d.Icon,{source:o.getAssetIDByName("ic_message_edit")}),onPress:function(){return l({role:"End",onSubmit:function(i){return r({start:n,end:i})}})}}),a!==void 0&&t.React.createElement(d,{label:t.React.createElement(m,V,"Remove End Time"),leading:t.React.createElement(d.Icon,{style:U.destructiveIcon,source:o.getAssetIDByName("trash")}),onPress:function(){r({start:n,end:void 0}),h.hideActionSheet()}})),t.React.createElement($,null))}const ee=function(e){let{role:n,button:a,secondaryButton:r,run:l,secondaryRun:i}=e;if(Ge())return l();S.showConfirmationAlert({title:"Unsaved Changes",content:["You have unsaved changes in ",t.React.createElement(re.Bold,null,s.activity.profile),`. Are you sure you want to ${n}?`],confirmText:a,confirmColor:"red",cancelText:"Cancel",onConfirm:l,secondaryConfirmText:r,onConfirmSecondary:function(){i?.(),l?.()}})},J=function(e){let{role:n,current:a,update:r}=e;return S.showInputAlert({title:`Enter New ${n}`,confirmText:"Change",confirmColor:"brand",cancelText:"Cancel",initialValue:a,placeholder:`really cool ${n.toLowerCase()}`,onConfirm:r})};//! for some reason the compiler breaks here and doesn't recognize ActivityType
const $t={"Vendetta Advertisement":{state:"Join Now",details:'"The best Discord client for mobile"',app:{name:"Vendetta"},timestamps:{},assets:{largeImg:"mp:external/t88vNcbCl2anXnBX4gmLVep17K_yqL4L2pvzwPMGtjs/%3Fsize%3D512/https/cdn.discordapp.com/icons/1015931589865246730/5b7f29e9c670fbcbf476b4d88fbd081f.png"},type:3,buttons:[{text:"Join Vendetta",url:"https://discord.gg/vendetta-mod"},{text:"Install Vendetta",url:"https://github.com/vendetta-mod/Vendetta#installing"}]},"Scuffed Spotify Activity":{timestamps:{start:"spotify.track.start",end:"spotify.track.end"},assets:{smallImg:"user.avatar",largeImg:"spotify.album"},buttons:[{text:"Listen Along",url:"{spotify.track.url}"}],app:{name:"{spotify.track}"},type:2,details:"by {spotify.artist}",state:"on {spotify.album}"},"My Profile":{timestamps:{start:0},assets:{largeImg:"user.avatar",smallImg:"user.presence"},buttons:[],app:{name:"{user.displayname}"},type:3,details:"{user.name}",state:"{user.status}"}},{View:Lt}=y.General,{FormRadioRow:Ot,FormRow:kt}=y.Forms,{showSimpleActionSheet:Ut}=g.findByProps("showSimpleActionSheet"),Vt=g.findByProps("openLazy","hideActionSheet");let te={import:void 0,add:void 0};const Mt=function(){const e=t.NavigationNative.useNavigation(),[n,a]=t.React.useReducer(function(c){return~c},0),[r,l]=t.React.useState("");t.React.useEffect(function(){l("")},[]),te.add=function(){return S.showInputAlert({title:"Enter new profile name",placeholder:"Super Awesome RPC",confirmText:"Add",confirmColor:"brand",cancelText:"Cancel",onConfirm:function(c){if(c.match(/^\s*$/))return p.showToast("Profile name cannot be empty",o.getAssetIDByName("Small"));if(c=c.trim(),s.profiles[c])return p.showToast("A profile with that name already exists",o.getAssetIDByName("Small"));s.profiles[c]=JSON.parse(JSON.stringify(s.activity.editing)),s.activity.profile=c,a(),p.showToast("Created profile",o.getAssetIDByName("Check"))}})},te.import=async function(){let c;try{c=JSON.parse(await t.clipboard.getString())}catch{return p.showToast("Failed to parse JSON")}if(!Je(c))return p.showToast("Invalid profile data",o.getAssetIDByName("Small"));let u=0,f="Imported Profile";for(;s.profiles[f];)u++,f=`Imported Profile (${u})`;s.profiles[f]=c,s.activity.profile=f,a(),p.showToast("Imported profile",o.getAssetIDByName("Check"))};let i=!1;return t.React.createElement(t.ReactNative.FlatList,{ListHeaderComponent:t.React.createElement(y.Search,{style:{marginBottom:10},onChangeText:function(c){return l(c.toLowerCase())}}),style:{paddingHorizontal:10,paddingTop:10},contentContainerStyle:{paddingBottom:20},data:Object.keys(s.profiles).filter(function(c){return c.toLowerCase().includes(r)}),renderItem:function(c){let{item:u}=c;return t.React.createElement(Ot,{label:u,onLongPress:function(){return Ut({key:"CardOverflow",header:{title:u,onClose:function(){return Vt.hideActionSheet()}},options:[{label:"Copy Profile",icon:o.getAssetIDByName("copy"),onPress:function(){t.clipboard.setString(JSON.stringify(s.profiles[u],void 0,3)),p.showToast("Copied",o.getAssetIDByName("toast_copy_link"))}},{label:"Rename Profile",icon:o.getAssetIDByName("ic_message_edit"),onPress:function(){return S.showInputAlert({title:"Enter new profile name",placeholder:"Super Awesome RPC 2.0",initialValue:u,confirmText:"Rename",confirmColor:"brand",cancelText:"Cancel",onConfirm:function(f){if(f.match(/^\s*$/))return p.showToast("Profile name cannot be empty",o.getAssetIDByName("Small"));if(f=f.trim(),s.profiles[f])return p.showToast("A profile with that name already exists",o.getAssetIDByName("Small"));s.profiles[f]=s.profiles[u],s.activity.profile===u&&(s.activity.profile=f),delete s.profiles[u],a(),p.showToast("Renamed profile",o.getAssetIDByName("Check"))}})}},{label:"Delete Profile",icon:o.getAssetIDByName("trash"),isDestructive:!0,onPress:function(){return S.showConfirmationAlert({title:"Delete Profile",content:"Are you sure you want to delete this profile? This cannot be undone.",confirmText:"Delete",confirmColor:"red",cancelText:"Cancel",onConfirm:function(){s.activity.profile===u&&(delete s.activity.profile,s.activity.editing=ne()),delete s.profiles[u],a(),ae?.(),p.showToast("Deleted",o.getAssetIDByName("Check"))}})}}]})},onPress:function(){if(!i){if(s.activity.profile===u)return p.showToast(`${u} is already loaded`,o.getAssetIDByName("Small"));ee({role:"discard your changes",button:"Discard",run:function(){s.activity.editing=JSON.parse(JSON.stringify(s.profiles[u])),s.activity.profile=u,i=!0,e.goBack(),ae?.(),p.showToast("Loaded",o.getAssetIDByName("Check"))},secondaryButton:"Save profile",secondaryRun:function(){s.profiles[s.activity.profile]=JSON.parse(JSON.stringify(s.activity.editing))}})}},trailing:t.React.createElement(kt.Arrow,null),selected:s.activity.profile===u})}})};function Ft(e){e.push("VendettaCustomPage",{render:Mt,title:"Profiles",headerRight:function(){return t.React.createElement(Lt,{style:{flexDirection:"row-reverse"}},t.React.createElement(G,{style:"header",icon:o.getAssetIDByName("ic_add_24px"),onPress:function(){return te.add?.()}}),t.React.createElement(G,{style:"header",icon:o.getAssetIDByName("ic_file_upload_24px"),onPress:function(){return te.import?.()}}))}})}const{View:Jt,Text:Ht}=y.General,{FormSection:Oe}=y.Forms;let ke;const zt=function(){const[e,n]=t.React.useReducer(function(r){return~r},0);ke=n;const a=t.stylesheet.createThemedStyleSheet({code:{fontFamily:t.constants.Fonts.CODE_SEMIBOLD,includeFontPadding:!1,color:R.semanticColors.TEXT_NORMAL}});return t.React.createElement(Jt,null,t.React.createElement(Oe,{title:"Live Raw Activity"},O.lastRawActivity?t.React.createElement(Ht,{style:a.code},JSON.stringify(O.lastRawActivity,void 0,3)):s.settings.display?t.React.createElement(m,{variant:"text-md/semibold"},"Display activity setting is disabled. You need to actually enable it for the raw activity to show up lmao"):t.React.createElement(m,{variant:"text-md/semibold",onPress:function(){return H()}},"No last raw activity yet. Tap text to force update")),t.React.createElement(Oe,{title:"Info"},t.React.createElement(m,{variant:"text-md/semibold",color:"TEXT_NORMAL"},"Last raw activity update:"," ",O.lastRawActivityTimestamp?new Date(O.lastRawActivityTimestamp).toLocaleString("en-US"):"-")))};function Gt(e){e.push("VendettaCustomPage",{render:zt,title:"Live RawActivity"})}const{ScrollView:Xt,View:Ue,Pressable:ea}=y.General,{FormSwitchRow:Ve,FormIcon:Me,FormRow:v}=y.Forms,jt=!1,A={image:"https://discord.com/assets/cb1043c312ec65507573c06c37f6ee63.gif",appName:"Enter App Name...",details:"Enter Details...",state:"Enter State...",timestamp:"Enter Timestamp...",button1:"Edit Button 1...",button2:"Edit Button 2..."},Fe={0:"Playing",2:"Listening to",3:"Watching",5:"Competing in"};t.stylesheet.createThemedStyleSheet({androidRipple:{color:R.semanticColors.ANDROID_RIPPLE,cornerRadius:8}});let ae;function Yt(){const e=t.NavigationNative.useNavigation(),[n,a]=t.React.useReducer(function(i){return~i},0);ae=a,s.settings??={edit:!1,display:!1,debug:{enabled:!1,visible:!1}},s.activity??={editing:ne()},s.profiles??=$t,We.useProxy(s),t.React.useEffect(function(){at(me.plugin,[{changes:["+ the entire plugin guhhh"]}])},[]),t.React.useEffect(function(){s.settings.display&&H()},[JSON.stringify(s.activity.editing),s.settings.display]),e.setOptions({headerRight:function(){return t.React.createElement(y.ErrorBoundary,null,t.React.createElement(Ue,{style:{flexDirection:"row-reverse"}},t.React.createElement(G,{style:"header",icon:o.getAssetIDByName("ic_report_message"),onPress:function(){return st("customrpc")}})))}});let r=0,l;return t.React.createElement(Xt,null,t.React.createElement(z,{title:"Preview",onTitlePress:function(){if(s.settings.debug.enabled)s.settings.debug.visible=!s.settings.debug.visible,p.showToast(`Debug tab ${s.settings.debug.visible?"visible":"hidden"}`);else{if(l&&clearTimeout(l),l=setTimeout(function(){r=0},750),r++,r<2)return;r<7?p.showToast(`${7-r} more taps...`):(p.showToast("Behold! You can now debug!"),s.settings.debug.visible=!0,s.settings.debug.enabled=!0,a())}},icon:o.getAssetIDByName("ic_eye"),padding:s.settings.edit},t.React.createElement(vt,{edit:s.settings.edit,act:s.activity.editing})),t.React.createElement(z,{title:"Settings",icon:o.getAssetIDByName("ic_cog_24px")},t.React.createElement(Ve,{label:"Edit Mode",subLabel:"Be able to edit your activity",leading:t.React.createElement(Me,{source:o.getAssetIDByName("ic_badge_staff")}),onValueChange:function(){return s.settings.edit=!s.settings.edit},value:s.settings.edit}),t.React.createElement(Ve,{label:"Display Activity",subLabel:"Show off your super awesome poggers activity to the world",leading:t.React.createElement(Me,{source:o.getAssetIDByName("ic_show_password")}),onValueChange:function(){return s.settings.display=!s.settings.display},value:s.settings.display})),t.React.createElement(z,{title:"Data",icon:o.getAssetIDByName("ic_feedback")},t.React.createElement(v,{label:"Copy as JSON",leading:t.React.createElement(v.Icon,{source:o.getAssetIDByName("copy")}),onPress:function(){t.clipboard.setString(JSON.stringify(s.activity.editing,void 0,3)),p.showToast("Copied",o.getAssetIDByName("toast_copy_link"))}}),t.React.createElement(v,{label:"Load from Clipboard",leading:t.React.createElement(v.Icon,{source:o.getAssetIDByName("ic_download_24px")}),onPress:function(){return ee({role:"overwrite the activity data",button:"Overwrite",run:async function(){let i;try{i=JSON.parse(await t.clipboard.getString())}catch{return p.showToast("Failed to parse JSON",o.getAssetIDByName("Small"))}if(!Je(i))return p.showToast("Invalid activity data",o.getAssetIDByName("Small"));s.activity.editing=Wt(i),delete s.activity.profile,a(),p.showToast("Loaded",o.getAssetIDByName("Check"))}})}}),t.React.createElement(tt,{addPadding:!0}),s.activity.profile&&t.React.createElement(v,{label:`Save Profile${Ge()?"":" \u{1F534}"}`,leading:t.React.createElement(v.Icon,{source:o.getAssetIDByName("ic_message_edit")}),onPress:function(){s.profiles[s.activity.profile]=JSON.parse(JSON.stringify(s.activity.editing)),p.showToast("Saved",o.getAssetIDByName("Check")),a()}}),s.activity.profile&&t.React.createElement(v,{label:"Revert Profile",leading:t.React.createElement(v.Icon,{source:o.getAssetIDByName("ic_message_edit")}),onPress:function(){return ee({role:"revert",button:"Revert",run:function(){s.activity.editing=JSON.parse(JSON.stringify(s.profiles[s.activity.profile])),p.showToast("Reverted",o.getAssetIDByName("Check")),a()}})}}),s.activity.profile&&t.React.createElement(v,{label:"Close Profile",leading:t.React.createElement(v.Icon,{source:o.getAssetIDByName("ic_message_edit")}),onPress:function(){return ee({role:"discard your changes",button:"Discard",run:function(){s.activity.editing=ne(),delete s.activity.profile,p.showToast("Closed",o.getAssetIDByName("Check")),a()},secondaryButton:"Save profile",secondaryRun:function(){s.profiles[s.activity.profile]=JSON.parse(JSON.stringify(s.activity.editing))}})}}),t.React.createElement(v,{label:"Browse Profiles",leading:t.React.createElement(v.Icon,{source:o.getAssetIDByName("ic_message_edit")}),trailing:t.React.createElement(v.Arrow,null),onPress:function(){return Ft(e)}})),s.settings.debug.visible&&t.React.createElement(z,{title:"Debug",icon:o.getAssetIDByName("ic_progress_wrench_24px")},t.React.createElement(v,{label:"Live RawActivity View",trailing:t.React.createElement(v.Arrow,null),leading:t.React.createElement(v.Icon,{source:o.getAssetIDByName("ic_badge_staff")}),onPress:function(){return Gt(e)}}),t.React.createElement(v,{label:"Flush MP Cache",leading:t.React.createElement(v.Icon,{source:o.getAssetIDByName("ic_badge_staff")}),onPress:function(){let i=0;for(const u of Object.keys(T))i++,delete T[u];const c=":3,>:3,:D,>:D,:P,>:P".split(",");p.showToast(`flushed cache ${c[Math.floor(Math.random()*c.length)]}`),i>0&&H()}}),jt),t.React.createElement(Ue,{style:{marginBottom:20}}))}var L;(function(e){e[e.Playing=0]="Playing",e[e.Listening=2]="Listening",e[e.Watching=3]="Watching",e[e.Competing=5]="Competing"})(L||(L={}));var ge;(function(e){e[e.Instance=1]="Instance",e[e.Join=2]="Join",e[e.Spectate=4]="Spectate",e[e.JoinRequest=8]="JoinRequest",e[e.Sync=16]="Sync",e[e.Play=32]="Play",e[e.PartyPrivacyFriends=64]="PartyPrivacyFriends",e[e.PartyPrivacyVoiceChannel=128]="PartyPrivacyVoiceChannel",e[e.Embedded=256]="Embedded"})(ge||(ge={}));function Je(e){if(!X(e)||!X(e.app)||"name"in e.app&&typeof e.app.name!="string"||"id"in e.app&&typeof e.app.id!="string"||"state"in e&&typeof e.state!="string"||"details"in e&&typeof e.details!="string"||!X(e.timestamps)||"start"in e.timestamps&&!(typeof e.timestamps.start=="number"||q.find(function(n){return n.format===e.timestamps.start}))||"end"in e.timestamps&&!(typeof e.timestamps.end=="number"||q.find(function(n){return n.format===e.timestamps.end}))||!X(e.assets)||"largeImg"in e.assets&&(typeof e.assets.largeImg!="string"||!(j(e.assets.largeImg)||Q.find(function(n){return n.format===e.assets.largeImg})))||"smallImg"in e.assets&&(typeof e.assets.smallImg!="string"||!(j(e.assets.smallImg)||Q.find(function(n){return n.format===e.assets.smallImg})))||!Array.isArray(e.buttons))return!1;for(const n of e.buttons)if(!("text"in n)||typeof n.text!="string"||"url"in n&&typeof n.url!="string")return!1;return!("type"in e&&!(e.type in L))}function Wt(e){return{app:{name:e.app.name,id:e.app.id},state:e.state,details:e.details,timestamps:{start:e.timestamps.start,end:e.timestamps.end},assets:{largeImg:e.assets.largeImg,smallImg:e.assets.smallImg},buttons:e.buttons.map(function(n){return{text:n.text,url:n.url}}),type:e.type}}function ne(){return{timestamps:{},assets:{},buttons:[],app:{}}}function He(e){const n=[],a={str:function(l){const i=St(l);for(const c of i.types)n.includes(c)||n.push(c);return i.content},tim:function(l){const i=It(l);return i.type&&!n.includes(i.type)&&n.push(i.type),i.timestamp!==void 0?oe(i.timestamp):void 0},img:function(l){const i=Ct(l);return i.type&&!n.includes(i.type)&&n.push(i.type),i.image}},r={name:a.str(e.app.name??A.appName),application_id:e.app.id??"0",type:e.type??L.Playing,flags:ge.Instance,state:e.state&&a.str(e.state),details:e.details&&a.str(e.details),timestamps:{start:e.timestamps.start!==void 0?a.tim(e.timestamps.start):void 0,end:e.timestamps.end!==void 0?a.tim(e.timestamps.end):void 0},assets:{large_image:e.assets.largeImg&&a.img(e.assets.largeImg),small_image:e.assets.smallImg&&a.img(e.assets.smallImg)}};return e.buttons[0]&&(r.metadata={button_urls:e.buttons.slice(0,2).filter(function(l){return!!l.text}).map(function(l){return l.url?a.str(l.url):null})},r.buttons=e.buttons.slice(0,2).filter(function(l){return!!l.text}).map(function(l){return a.str(l.text)})),O.lastRawActivity=r,O.lastRawActivityTimestamp=Date.now(),ke?.(),{activity:r,types:n}}async function ye(e){let n={};if(_e(),e){const a=He(e);n=a.activity,Nt(a.types)}t.FluxDispatcher.dispatch({type:"LOCAL_ACTIVITY_UPDATE",activity:n,socketId:"VendettaCustomRpcPlugin"})}function ze(){return s.profiles?.[s.activity?.profile]??s.activity?.editing??ne()}function H(){const e=ze();s.settings?.display?ye(e):ye()}function Ge(){const e=ze();return JSON.stringify(e)===JSON.stringify(s.activity.editing)}const s=je.storage,O={lastRawActivity:void 0,lastRawActivityTimestamp:void 0};var Kt={onLoad:function(){H(),bt()},onUnload:function(){ye(),_e(!0)},settings:Yt};return M.debug=O,M.default=Kt,M.vstorage=s,Object.defineProperty(M,"__esModule",{value:!0}),M})({},vendetta.plugin,vendetta.metro.common,vendetta.ui.alerts,vendetta.metro,vendetta.ui,vendetta.ui.components,vendetta,vendetta.ui.assets,vendetta.debug,vendetta.ui.toasts,vendetta.utils,vendetta.storage);
