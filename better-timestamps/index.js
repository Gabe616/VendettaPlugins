(function(S,h,e,L,p,m,_,B,d,x){"use strict";const{TextStyleSheet:F}=h.findByProps("TextStyleSheet"),{View:E,Text:A}=m.General,{FormRow:k}=m.Forms;function w(n){let{title:s,icon:l,children:u,padding:a}=n;const r=e.stylesheet.createThemedStyleSheet({mainText:{fontFamily:e.constants.Fonts.PRIMARY_SEMIBOLD,fontSize:14,includeFontPadding:!1,letterSpacing:void 0,lineHeight:18,textTransform:"none",color:d.semanticColors.HEADER_SECONDARY},main:{backgroundColor:d.semanticColors.BACKGROUND_TERTIARY,borderRadius:16,overflow:"hidden",flex:1}});return e.React.createElement(E,{style:{marginHorizontal:16,marginTop:16}},e.React.createElement(E,{style:{marginBottom:8,flexDirection:"row",justifyContent:"flex-start",alignItems:"center"}},l&&e.React.createElement(E,{style:{marginRight:4}},e.React.createElement(k.Icon,{source:l,size:"small"})),e.React.createElement(A,{style:r.mainText},s)),e.React.createElement(E,{style:r.main},a?e.React.createElement(E,{style:{paddingHorizontal:16,paddingVertical:16}},u):u))}var D;(function(n){function s(l){let{children:u}=l;return e.React.createElement(A,{style:F["text-md/bold"]},u)}n.Bold=s})(D||(D={}));const{ScrollView:H,Text:g}=m.General,{FormSwitchRow:N,FormIcon:v}=m.Forms,{parseTimestamp:I}=h.findByProps("parseTimestamp","unparseTimestamp");function O(n){let{style:s}=n;const[l,u]=e.React.useReducer(function(i){return~i},0),a=new Date().setMilliseconds(1e3);setTimeout(function(){return u()},a-Date.now());const r=new Date,R=[[4],[19,20],[4,18,2],r.getHours()<12&&[r.getHours()],[r.getHours(),r.getMinutes()],[r.getHours(),r.getMinutes(),r.getSeconds()]].filter(function(i){return!!i}),f=[];let M=-1;for(const[i,o,y]of R){M++;const c=new Date;c.setHours(i,o??0,y||0);let T=[c.getHours().toString(),o!==void 0&&c.getMinutes().toString().padStart(2,"0"),y!==void 0&&c.getSeconds().toString().padStart(2,"0")].filter(function(Y){return!!Y}).join(":");i<12&&(T+=" AM");const b=I(Math.floor(c.getTime()/1e3).toString(),t.alwaysLong?"T":"t");f.push(t.reqBackticks?e.React.createElement(g,{style:s.code},T):T),f.push(" \u2014 "),f.push(e.React.createElement(g,{style:s.timestamp,onPress:function(){return x.showToast(b.full,p.getAssetIDByName("ic_information_24px"))}},b.formatted)),M!==R.length-1&&f.push(`
`)}return e.React.createElement(e.React.Fragment,null,...f)}function P(){t.reqBackticks??=!0,t.alwaysLong??=!1,L.useProxy(t);const n=e.stylesheet.createThemedStyleSheet({mainText:{fontFamily:e.constants.Fonts.DISPLAY_NORMAL,includeFontPadding:!1,fontSize:16,color:d.semanticColors.TEXT_NORMAL},boldText:{fontFamily:e.constants.Fonts.DISPLAY_BOLD,includeFontPadding:!1,color:d.semanticColors.TEXT_NORMAL},code:{fontFamily:e.constants.Fonts.CODE_SEMIBOLD,includeFontPadding:!1,color:d.semanticColors.TEXT_NORMAL,backgroundColor:d.semanticColors.BACKGROUND_SECONDARY},timestamp:{fontFamily:e.constants.Fonts.DISPLAY_NORMAL,includeFontPadding:!1,color:d.semanticColors.TEXT_NORMAL,backgroundColor:d.semanticColors.BACKGROUND_MODIFIER_ACCENT}});return e.React.createElement(H,null,e.React.createElement(w,{title:"Info",icon:p.getAssetIDByName("ic_info_24px"),padding:!0},e.React.createElement(g,{style:n.mainText},"Send a message with a time code (in",e.React.createElement(g,{style:n.boldText}," HH:MM")," or",e.React.createElement(g,{style:n.boldText}," HH:MM:SS")," format) and automatically turn it into a timestamp",`

`,e.React.createElement(O,{style:n}))),e.React.createElement(w,{title:"Settings",icon:p.getAssetIDByName("settings")},e.React.createElement(N,{label:"Require Backticks",subLabel:"Require time to be surrounded by backticks",leading:e.React.createElement(v,{source:p.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return t.reqBackticks=!t.reqBackticks},value:t.reqBackticks}),e.React.createElement(N,{label:"Always Long Time",subLabel:["Always display ",e.React.createElement(g,{style:n.boldText},"HH:MM:SS")," instead of ",e.React.createElement(g,{style:n.boldText},"HH:MM")],leading:e.React.createElement(v,{source:p.getAssetIDByName("ic_message_edit")}),onValueChange:function(){return t.alwaysLong=!t.alwaysLong},value:t.alwaysLong})))}const $=h.findByProps("sendMessage","receiveMessage"),t=B.storage;let C;var q={onLoad:function(){C=_.before("sendMessage",$,function(n){const s=n[1];let l=s?.content;if(typeof l!="string"||typeof s!="object")return;const u=t.reqBackticks?"`":"\\s",a={otN:"[0-9]{1,2}",tN:"[0-9]{2}",abrv:"(?: ?(AM|PM))"},r=[`(${a.otN}:${a.tN}:${a.tN})${a.abrv}?`,`(${a.otN}:${a.tN})${a.abrv}?`,`(${a.otN})${a.abrv}`].map(function(R){return new RegExp(`${u}${R}${u}`,"gi")});for(const R of r)l=l.replace(R,function(f,M,i){let[o,y,c]=M.split(":").map(function(b){return parseInt(b)});if(o<0||o>24||typeof y=="number"&&(y<0||y>60)||typeof c=="number"&&(c<0||c>60))return f;i&&(i.toLowerCase()==="pm"&&o!==12?o+=12:i.toLowerCase()==="am"&&o===12&&(o=0));const T=new Date;return T.setHours(o,y??0,c??0,0),`<t:${Math.floor(T.getTime()/1e3)}:${t.alwaysLong?"T":"t"}>`});s.content=l})},onUnload:function(){return C?.()},settings:P};return S.default=q,S.vstorage=t,Object.defineProperty(S,"__esModule",{value:!0}),S})({},vendetta.metro,vendetta.metro.common,vendetta.storage,vendetta.ui.assets,vendetta.ui.components,vendetta.patcher,vendetta.plugin,vendetta.ui,vendetta.ui.toasts);
